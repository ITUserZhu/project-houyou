"use strict";$(function(){var i=$(".other-pic").children("ul"),e=$(".con-img"),n=$("#popped-up"),l=$("#popped-img-wra");i.clone().appendTo("#popped-img-wra");var c=l.find("li").width(),r=l.children("ul").children("li").length;l.children("ul").width(c*r),e.click(function(i){var e=$(this).index();l.children("ul").css("marginLeft",-e*c+"px"),__commonToggleActive(l.children("ul").children("li").eq(e),"cur"),n.fadeIn()}),n.click(function(i){var e=$(i.target).closest("div"),t=l.find("li.cur").index();if(e.is(".close"))n.fadeOut();else{if(e.is(".prev-btn")){if(--t<0)return}else if(e.is(".next-btn")&&r-1<++t)return;l.children("ul").animate({marginLeft:-t*c+"px"},400),__commonToggleActive(l.children("ul").children("li").eq(t),"cur")}});var o=$(".img-wra"),d=o.find("ul"),a=d.children("li").length,f=o.find(".img").width(),s=$(".other-pic"),h=s.find("ul"),u=s.find("li").outerWidth()/1+12,m=0,g=$(".next-atlas");o.click(function(i){var e=$(this).find("li.active").index(),t=$(i.target).closest("div");if(t.is(".prev-btn")){if(e<1)return o.hide(),void g.show();e--}else if(t.is(".next-btn")){if(a-2<e)return o.hide(),void g.show();e++}m=Math.floor(e/6),h.animate({marginLeft:6*u*-m+"px"},400),__commonToggleActive([d.children("li").eq(e),h.children("li").eq(e)]),d.animate({marginLeft:-e*f+"px"},400)}),h.width(s.find("li").length*u),s.click(function(i){if(0<$(i.target).closest("li").length){o.show(),g.hide();var e=$(i.target).closest("li").index();return __commonToggleActive([$(i.target).closest("li"),d.children("li").eq(e)]),void d.stop().animate({marginLeft:-e*f+"px"},400)}var t=$(i.target).closest("div"),n=Math.ceil(s.find("li").length/6);if(t.is(".arr-left")){if(--m<0)return void m++}else if(t.is(".arr-right")&&n-1<++m)return void m--;h.animate({marginLeft:6*u*-m+"px"},400)});var t=$("#collect"),p=$("#model"),v=p.data("model"),x=p.data("id"),k={title:p.data("title"),model_id:v,res_id:x,is_click:!1};function _(e){$.ajax({url:"/collection",type:"POST",data:e}).done(function(i){switch(i.message){case"已收藏":t.find("em").text("已收藏"),t.find("i").css("color","red");break;case"未收藏":t.find("em").text("点击收藏"),t.find("i").css("color","#fff");break;case"收藏成功":t.find("em").text("已收藏"),t.find("i").css("color","red");break;case"取消收藏":t.find("em").text("点击收藏"),t.find("i").css("color","#fff");break;case"用户未登陆":e.is_click?(t.find("em").text("点击收藏"),t.find("i").css("color","#fff"),$("#login-btn").click()):(t.find("em").text("点击收藏"),t.find("i").css("color","#fff"))}}).fail(function(i){console.log(i)})}t.on("click",function(){k.is_click=!0,_(k)}),_(k),setTimeout(function(){$.ajax({url:"/tools/stat/"+v+"/"+x,type:"GET",success:function(i){}})},1e3)});